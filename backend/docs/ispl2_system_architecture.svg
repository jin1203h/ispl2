<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1400" style="background-color: #1e1e1e;">
  <!-- 다크 테마 배경 -->
  <rect width="100%" height="100%" fill="#1e1e1e"/>
  
  <!-- 제목 -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#4fc3f7">
    🏗️ ISPL2 보험약관 AI 시스템 - 현재 구현 아키텍처
  </text>
  
  <!-- 1. 프론트엔드 레이어 -->
  <g id="frontend-layer">
    <rect x="50" y="60" width="1100" height="120" rx="8" fill="#2196F3" stroke="#01579b" stroke-width="2"/>
    <text x="600" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#ffffff">
      🖥️ 프론트엔드 레이어 (React + Next.js + TypeScript)
    </text>
    
    <!-- 프론트엔드 컴포넌트들 -->
    <rect x="70" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="130" y="120" text-anchor="middle" font-size="10" fill="#ffffff">💬 ChatInterface</text>
    <text x="130" y="135" text-anchor="middle" font-size="10" fill="#ffffff">AI 채팅 인터페이스</text>
    
    <rect x="210" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="270" y="120" text-anchor="middle" font-size="10" fill="#ffffff">📄 PolicyManagement</text>
    <text x="270" y="135" text-anchor="middle" font-size="10" fill="#ffffff">약관 관리</text>
    
    <rect x="350" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="410" y="120" text-anchor="middle" font-size="10" fill="#ffffff">📊 WorkflowMonitoring</text>
    <text x="410" y="135" text-anchor="middle" font-size="10" fill="#ffffff">워크플로우 모니터링</text>
    
    <rect x="490" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="550" y="120" text-anchor="middle" font-size="10" fill="#ffffff">📈 PerformanceDashboard</text>
    <text x="550" y="135" text-anchor="middle" font-size="10" fill="#ffffff">성능 대시보드</text>
    
    <rect x="630" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="690" y="120" text-anchor="middle" font-size="10" fill="#ffffff">🔐 Login</text>
    <text x="690" y="135" text-anchor="middle" font-size="10" fill="#ffffff">사용자 인증</text>
    
    <rect x="770" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="830" y="120" text-anchor="middle" font-size="10" fill="#ffffff">🔌 API Client</text>
    <text x="830" y="135" text-anchor="middle" font-size="10" fill="#ffffff">HTTP 통신</text>
    
    <rect x="910" y="100" width="120" height="60" rx="4" fill="#1976D2" stroke="#0d47a1" stroke-width="1"/>
    <text x="970" y="120" text-anchor="middle" font-size="10" fill="#ffffff">👤 AuthContext</text>
    <text x="970" y="135" text-anchor="middle" font-size="10" fill="#ffffff">인증 상태 관리</text>
  </g>
  
  <!-- 2. 백엔드 레이어 -->
  <g id="backend-layer">
    <rect x="50" y="200" width="1100" height="120" rx="8" fill="#4CAF50" stroke="#2e7d32" stroke-width="2"/>
    <text x="600" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#ffffff">
      ⚙️ 백엔드 레이어 (FastAPI + Python)
    </text>
    
    <!-- 백엔드 컴포넌트들 -->
    <rect x="70" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="120" y="260" text-anchor="middle" font-size="9" fill="#ffffff">🔑 인증 API</text>
    <text x="120" y="275" text-anchor="middle" font-size="9" fill="#ffffff">/auth/*</text>
    
    <rect x="190" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="240" y="260" text-anchor="middle" font-size="9" fill="#ffffff">📋 약관 관리 API</text>
    <text x="240" y="275" text-anchor="middle" font-size="9" fill="#ffffff">/policies/*</text>
    
    <rect x="310" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="360" y="260" text-anchor="middle" font-size="9" fill="#ffffff">🔍 검색 API</text>
    <text x="360" y="275" text-anchor="middle" font-size="9" fill="#ffffff">/search/*</text>
    
    <rect x="430" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="480" y="260" text-anchor="middle" font-size="9" fill="#ffffff">📈 워크플로우 API</text>
    <text x="480" y="275" text-anchor="middle" font-size="9" fill="#ffffff">/workflow/*</text>
    
    <rect x="550" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="600" y="260" text-anchor="middle" font-size="9" fill="#ffffff">📊 대시보드 API</text>
    <text x="600" y="275" text-anchor="middle" font-size="9" fill="#ffffff">/dashboard/*</text>
    
    <rect x="670" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="720" y="260" text-anchor="middle" font-size="9" fill="#ffffff">🔐 인증 서비스</text>
    <text x="720" y="275" text-anchor="middle" font-size="9" fill="#ffffff">JWT 토큰 관리</text>
    
    <rect x="790" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="840" y="260" text-anchor="middle" font-size="9" fill="#ffffff">💾 DB 서비스</text>
    <text x="840" y="275" text-anchor="middle" font-size="9" fill="#ffffff">SQLAlchemy ORM</text>
    
    <rect x="910" y="240" width="100" height="60" rx="4" fill="#388E3C" stroke="#1b5e20" stroke-width="1"/>
    <text x="960" y="260" text-anchor="middle" font-size="9" fill="#ffffff">🗂️ 벡터 저장소</text>
    <text x="960" y="275" text-anchor="middle" font-size="9" fill="#ffffff">pgvector 연동</text>
  </g>
  
  <!-- 3. Multi-Agent 시스템 -->
  <g id="agent-layer">
    <rect x="50" y="340" width="1100" height="120" rx="8" fill="#FF5722" stroke="#d32f2f" stroke-width="2"/>
    <text x="600" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#ffffff">
      🤖 Multi-Agent 시스템 (LangGraph)
    </text>
    
    <!-- Multi-Agent 컴포넌트들 -->
    <rect x="70" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="110" y="400" text-anchor="middle" font-size="8" fill="#ffffff">🎯 Supervisor</text>
    <text x="110" y="415" text-anchor="middle" font-size="8" fill="#ffffff">워크플로우 조율</text>
    
    <rect x="170" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="210" y="400" text-anchor="middle" font-size="8" fill="#ffffff">📄 PDF Processor</text>
    <text x="210" y="415" text-anchor="middle" font-size="8" fill="#ffffff">PDF 구조 분석</text>
    
    <rect x="270" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="310" y="400" text-anchor="middle" font-size="8" fill="#ffffff">📝 Text Processor</text>
    <text x="310" y="415" text-anchor="middle" font-size="8" fill="#ffffff">텍스트 추출/정제</text>
    
    <rect x="370" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="410" y="400" text-anchor="middle" font-size="8" fill="#ffffff">📊 Table Processor</text>
    <text x="410" y="415" text-anchor="middle" font-size="8" fill="#ffffff">표 데이터 구조화</text>
    
    <rect x="470" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="510" y="400" text-anchor="middle" font-size="8" fill="#ffffff">🖼️ Image Processor</text>
    <text x="510" y="415" text-anchor="middle" font-size="8" fill="#ffffff">OCR/이미지 분석</text>
    
    <rect x="570" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="610" y="400" text-anchor="middle" font-size="8" fill="#ffffff">📝 Markdown</text>
    <text x="610" y="415" text-anchor="middle" font-size="8" fill="#ffffff">마크다운 변환</text>
    
    <rect x="670" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="710" y="400" text-anchor="middle" font-size="8" fill="#ffffff">🔍 Query Processor</text>
    <text x="710" y="415" text-anchor="middle" font-size="8" fill="#ffffff">질의 전처리</text>
    
    <rect x="770" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="810" y="400" text-anchor="middle" font-size="8" fill="#ffffff">🔎 Search Engine</text>
    <text x="810" y="415" text-anchor="middle" font-size="8" fill="#ffffff">하이브리드 검색</text>
    
    <rect x="870" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="910" y="400" text-anchor="middle" font-size="8" fill="#ffffff">📋 Result Service</text>
    <text x="910" y="415" text-anchor="middle" font-size="8" fill="#ffffff">결과 후처리</text>
    
    <rect x="970" y="380" width="80" height="60" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="1010" y="400" text-anchor="middle" font-size="8" fill="#ffffff">🤖 Answer Service</text>
    <text x="1010" y="415" text-anchor="middle" font-size="8" fill="#ffffff">LLM 답변 생성</text>
  </g>
  
  <!-- 4. 데이터베이스 레이어 -->
  <g id="database-layer">
    <rect x="50" y="480" width="1100" height="120" rx="8" fill="#9C27B0" stroke="#7b1fa2" stroke-width="2"/>
    <text x="600" y="505" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#ffffff">
      🗄️ 데이터베이스 레이어 (PostgreSQL + pgvector)
    </text>
    
    <!-- 데이터베이스 컴포넌트들 -->
    <rect x="70" y="520" width="120" height="60" rx="4" fill="#8E24AA" stroke="#6a1b9a" stroke-width="1"/>
    <text x="130" y="540" text-anchor="middle" font-size="10" fill="#ffffff">👥 users</text>
    <text x="130" y="555" text-anchor="middle" font-size="10" fill="#ffffff">사용자 정보</text>
    
    <rect x="210" y="520" width="120" height="60" rx="4" fill="#8E24AA" stroke="#6a1b9a" stroke-width="1"/>
    <text x="270" y="540" text-anchor="middle" font-size="10" fill="#ffffff">📑 policies</text>
    <text x="270" y="555" text-anchor="middle" font-size="10" fill="#ffffff">약관 메타데이터</text>
    
    <rect x="350" y="520" width="120" height="60" rx="4" fill="#8E24AA" stroke="#6a1b9a" stroke-width="1"/>
    <text x="410" y="540" text-anchor="middle" font-size="10" fill="#ffffff">📋 workflow_logs</text>
    <text x="410" y="555" text-anchor="middle" font-size="10" fill="#ffffff">워크플로우 실행 로그</text>
    
    <rect x="490" y="520" width="140" height="60" rx="4" fill="#8E24AA" stroke="#6a1b9a" stroke-width="1"/>
    <text x="560" y="540" text-anchor="middle" font-size="10" fill="#ffffff">🧠 embeddings_text_embedding_3</text>
    <text x="560" y="555" text-anchor="middle" font-size="10" fill="#ffffff">3072차원 벡터</text>
    
    <rect x="650" y="520" width="140" height="60" rx="4" fill="#8E24AA" stroke="#6a1b9a" stroke-width="1"/>
    <text x="720" y="540" text-anchor="middle" font-size="10" fill="#ffffff">🧠 embeddings_qwen</text>
    <text x="720" y="555" text-anchor="middle" font-size="10" fill="#ffffff">4096차원 벡터</text>
    
    <rect x="810" y="520" width="140" height="60" rx="4" fill="#8E24AA" stroke="#6a1b9a" stroke-width="1"/>
    <text x="880" y="540" text-anchor="middle" font-size="10" fill="#ffffff">🔍 pgvector</text>
    <text x="880" y="555" text-anchor="middle" font-size="10" fill="#ffffff">벡터 인덱스 및 검색</text>
  </g>
  
  <!-- 5. 모니터링 레이어 -->
  <g id="monitoring-layer">
    <rect x="50" y="620" width="1100" height="120" rx="8" fill="#607D8B" stroke="#455a64" stroke-width="2"/>
    <text x="600" y="645" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#ffffff">
      📊 모니터링 및 성능 추적
    </text>
    
    <!-- 모니터링 컴포넌트들 -->
    <rect x="200" y="660" width="200" height="60" rx="4" fill="#546E7A" stroke="#37474f" stroke-width="1"/>
    <text x="300" y="680" text-anchor="middle" font-size="10" fill="#ffffff">📈 실시간 대시보드</text>
    <text x="300" y="695" text-anchor="middle" font-size="10" fill="#ffffff">Recharts 시각화</text>
    
    <rect x="420" y="660" width="200" height="60" rx="4" fill="#546E7A" stroke="#37474f" stroke-width="1"/>
    <text x="520" y="680" text-anchor="middle" font-size="10" fill="#ffffff">📊 성능 메트릭 수집</text>
    <text x="520" y="695" text-anchor="middle" font-size="10" fill="#ffffff">응답시간, 성공률</text>
    
    <rect x="640" y="660" width="200" height="60" rx="4" fill="#546E7A" stroke="#37474f" stroke-width="1"/>
    <text x="740" y="680" text-anchor="middle" font-size="10" fill="#ffffff">🚨 알림 시스템</text>
    <text x="740" y="695" text-anchor="middle" font-size="10" fill="#ffffff">오류 감지</text>
  </g>
  
  <!-- 외부 서비스 -->
  <g id="external-services">
    <rect x="50" y="760" width="300" height="120" rx="8" fill="#FF9800" stroke="#f57c00" stroke-width="2"/>
    <text x="200" y="785" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#ffffff">
      🌐 외부 서비스
    </text>
    
    <rect x="70" y="800" width="80" height="60" rx="4" fill="#F57C00" stroke="#e65100" stroke-width="1"/>
    <text x="110" y="820" text-anchor="middle" font-size="9" fill="#ffffff">🤖 OpenAI API</text>
    <text x="110" y="835" text-anchor="middle" font-size="9" fill="#ffffff">GPT-4, embedding</text>
    
    <rect x="170" y="800" width="80" height="60" rx="4" fill="#F57C00" stroke="#e65100" stroke-width="1"/>
    <text x="210" y="820" text-anchor="middle" font-size="9" fill="#ffffff">📊 LangFuse</text>
    <text x="210" y="835" text-anchor="middle" font-size="9" fill="#ffffff">워크플로우 모니터링</text>
    
    <rect x="270" y="800" width="60" height="60" rx="4" fill="#F57C00" stroke="#e65100" stroke-width="1"/>
    <text x="300" y="820" text-anchor="middle" font-size="9" fill="#ffffff">🔗 MCP</text>
    <text x="300" y="835" text-anchor="middle" font-size="9" fill="#ffffff">자동 Tool 호출</text>
  </g>
  
  <!-- 연결선들 -->
  <!-- Frontend -> Backend -->
  <line x1="600" y1="180" x2="600" y2="200" stroke="#6b7280" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Backend -> Agent System -->
  <line x1="600" y1="320" x2="600" y2="340" stroke="#6b7280" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Agent System -> Database -->
  <line x1="600" y1="460" x2="600" y2="480" stroke="#6b7280" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Database -> Monitoring -->
  <line x1="600" y1="600" x2="600" y2="620" stroke="#6b7280" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- 화살표 마커 정의 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6b7280"/>
    </marker>
  </defs>
  
  <!-- 연결 설명 텍스트 -->
  <text x="650" y="195" font-family="Arial, sans-serif" font-size="12" fill="#6b7280">HTTP API 호출</text>
  <text x="650" y="335" font-family="Arial, sans-serif" font-size="12" fill="#6b7280">Multi-Agent 실행</text>
  <text x="650" y="475" font-family="Arial, sans-serif" font-size="12" fill="#6b7280">데이터 저장/조회</text>
  <text x="650" y="615" font-family="Arial, sans-serif" font-size="12" fill="#6b7280">성능 모니터링</text>
</svg>




