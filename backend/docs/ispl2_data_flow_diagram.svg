<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1000" style="background-color: #1e1e1e;">
  <!-- 다크 테마 배경 -->
  <rect width="100%" height="100%" fill="#1e1e1e"/>
  
  <!-- 제목 -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#4fc3f7">
    🔄 ISPL2 데이터 플로우 다이어그램
  </text>
  
  <!-- 사용자 -->
  <g id="user">
    <rect x="550" y="60" width="100" height="60" rx="8" fill="#2196F3" stroke="#01579b" stroke-width="2"/>
    <text x="600" y="85" text-anchor="middle" font-size="12" font-weight="bold" fill="#ffffff">👤 사용자</text>
    <text x="600" y="100" text-anchor="middle" font-size="10" fill="#ffffff">웹 브라우저</text>
  </g>
  
  <!-- 문서 처리 플로우 -->
  <g id="processing-flow">
    <rect x="50" y="160" width="500" height="350" rx="8" fill="#FF5722" stroke="#d32f2f" stroke-width="2" fill-opacity="0.1"/>
    <text x="300" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#FF5722">
      📄 문서 처리 플로우
    </text>
    
    <!-- 업로드 -->
    <rect x="70" y="200" width="120" height="50" rx="4" fill="#FF5722" stroke="#d32f2f" stroke-width="1"/>
    <text x="130" y="220" text-anchor="middle" font-size="11" fill="#ffffff">📤 PDF 업로드</text>
    <text x="130" y="235" text-anchor="middle" font-size="9" fill="#ffffff">파일 선택</text>
    
    <!-- Supervisor Agent -->
    <rect x="220" y="200" width="120" height="50" rx="4" fill="#FF5722" stroke="#d32f2f" stroke-width="1"/>
    <text x="280" y="220" text-anchor="middle" font-size="11" fill="#ffffff">🎯 Supervisor Agent</text>
    <text x="280" y="235" text-anchor="middle" font-size="9" fill="#ffffff">워크플로우 시작</text>
    
    <!-- 병렬 처리 박스 -->
    <rect x="70" y="270" width="460" height="120" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1" fill-opacity="0.2"/>
    <text x="300" y="290" text-anchor="middle" font-size="12" font-weight="bold" fill="#E64A19">🔄 병렬 처리</text>
    
    <!-- PDF 분석 -->
    <rect x="90" y="300" width="80" height="50" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="130" y="320" text-anchor="middle" font-size="9" fill="#ffffff">📄 PDF 분석</text>
    <text x="130" y="335" text-anchor="middle" font-size="9" fill="#ffffff">구조 파악</text>
    
    <!-- 텍스트 추출 -->
    <rect x="190" y="300" width="80" height="50" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="230" y="320" text-anchor="middle" font-size="9" fill="#ffffff">📝 텍스트 추출</text>
    <text x="230" y="335" text-anchor="middle" font-size="9" fill="#ffffff">내용 정제</text>
    
    <!-- 표 추출 -->
    <rect x="290" y="300" width="80" height="50" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="330" y="320" text-anchor="middle" font-size="9" fill="#ffffff">📊 표 추출</text>
    <text x="330" y="335" text-anchor="middle" font-size="9" fill="#ffffff">데이터 구조화</text>
    
    <!-- 이미지 OCR -->
    <rect x="390" y="300" width="80" height="50" rx="4" fill="#E64A19" stroke="#bf360c" stroke-width="1"/>
    <text x="430" y="320" text-anchor="middle" font-size="9" fill="#ffffff">🖼️ 이미지 OCR</text>
    <text x="430" y="335" text-anchor="middle" font-size="9" fill="#ffffff">텍스트 인식</text>
    
    <!-- 마크다운 변환 -->
    <rect x="70" y="410" width="120" height="50" rx="4" fill="#FF5722" stroke="#d32f2f" stroke-width="1"/>
    <text x="130" y="430" text-anchor="middle" font-size="11" fill="#ffffff">📝 마크다운 변환</text>
    <text x="130" y="445" text-anchor="middle" font-size="9" fill="#ffffff">통합 문서 생성</text>
    
    <!-- 임베딩 생성 -->
    <rect x="220" y="410" width="120" height="50" rx="4" fill="#FF5722" stroke="#d32f2f" stroke-width="1"/>
    <text x="280" y="430" text-anchor="middle" font-size="11" fill="#ffffff">🧠 임베딩 생성</text>
    <text x="280" y="445" text-anchor="middle" font-size="9" fill="#ffffff">벡터화</text>
    
    <!-- 벡터 저장 -->
    <rect x="370" y="410" width="120" height="50" rx="4" fill="#9C27B0" stroke="#7b1fa2" stroke-width="1"/>
    <text x="430" y="430" text-anchor="middle" font-size="11" fill="#ffffff">🗂️ 벡터 저장</text>
    <text x="430" y="445" text-anchor="middle" font-size="9" fill="#ffffff">pgvector DB</text>
    
    <!-- 처리 완료 -->
    <rect x="370" y="480" width="120" height="50" rx="4" fill="#4CAF50" stroke="#2e7d32" stroke-width="1"/>
    <text x="430" y="500" text-anchor="middle" font-size="11" fill="#ffffff">✅ 처리 완료</text>
    <text x="430" y="515" text-anchor="middle" font-size="9" fill="#ffffff">검색 가능</text>
  </g>
  
  <!-- 질의 응답 플로우 -->
  <g id="query-flow">
    <rect x="650" y="160" width="500" height="350" rx="8" fill="#4CAF50" stroke="#2e7d32" stroke-width="2" fill-opacity="0.1"/>
    <text x="900" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#4CAF50">
      💬 질의 응답 플로우
    </text>
    
    <!-- 사용자 질의 -->
    <rect x="670" y="200" width="120" height="50" rx="4" fill="#4CAF50" stroke="#2e7d32" stroke-width="1"/>
    <text x="730" y="220" text-anchor="middle" font-size="11" fill="#ffffff">💭 사용자 질의</text>
    <text x="730" y="235" text-anchor="middle" font-size="9" fill="#ffffff">자연어 입력</text>
    
    <!-- RAG 검색 -->
    <rect x="820" y="200" width="120" height="50" rx="4" fill="#4CAF50" stroke="#2e7d32" stroke-width="1"/>
    <text x="880" y="220" text-anchor="middle" font-size="11" fill="#ffffff">🔍 RAG 검색</text>
    <text x="880" y="235" text-anchor="middle" font-size="9" fill="#ffffff">유사도 검색</text>
    
    <!-- 컨텍스트 검색 -->
    <rect x="970" y="200" width="120" height="50" rx="4" fill="#4CAF50" stroke="#2e7d32" stroke-width="1"/>
    <text x="1030" y="220" text-anchor="middle" font-size="11" fill="#ffffff">📋 컨텍스트 검색</text>
    <text x="1030" y="235" text-anchor="middle" font-size="9" fill="#ffffff">관련 청크 추출</text>
    
    <!-- GPT 응답 -->
    <rect x="820" y="300" width="120" height="50" rx="4" fill="#4CAF50" stroke="#2e7d32" stroke-width="1"/>
    <text x="880" y="320" text-anchor="middle" font-size="11" fill="#ffffff">🤖 GPT-4 응답</text>
    <text x="880" y="335" text-anchor="middle" font-size="9" fill="#ffffff">답변 생성</text>
    
    <!-- 구조화된 답변 -->
    <rect x="670" y="300" width="120" height="50" rx="4" fill="#4CAF50" stroke="#2e7d32" stroke-width="1"/>
    <text x="730" y="320" text-anchor="middle" font-size="11" fill="#ffffff">📝 구조화된 답변</text>
    <text x="730" y="335" text-anchor="middle" font-size="9" fill="#ffffff">사용자에게 전달</text>
  </g>
  
  <!-- 모니터링 플로우 -->
  <g id="monitoring-flow">
    <rect x="350" y="550" width="500" height="200" rx="8" fill="#607D8B" stroke="#455a64" stroke-width="2" fill-opacity="0.1"/>
    <text x="600" y="575" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#607D8B">
      📊 모니터링 플로우
    </text>
    
    <!-- 에이전트 실행 -->
    <rect x="370" y="590" width="100" height="50" rx="4" fill="#607D8B" stroke="#455a64" stroke-width="1"/>
    <text x="420" y="610" text-anchor="middle" font-size="10" fill="#ffffff">🎯 에이전트 실행</text>
    <text x="420" y="625" text-anchor="middle" font-size="9" fill="#ffffff">작업 수행</text>
    
    <!-- 로그 수집 -->
    <rect x="490" y="590" width="100" height="50" rx="4" fill="#607D8B" stroke="#455a64" stroke-width="1"/>
    <text x="540" y="610" text-anchor="middle" font-size="10" fill="#ffffff">📋 로그 수집</text>
    <text x="540" y="625" text-anchor="middle" font-size="9" fill="#ffffff">workflow_logs</text>
    
    <!-- 성능 수집 -->
    <rect x="610" y="590" width="100" height="50" rx="4" fill="#607D8B" stroke="#455a64" stroke-width="1"/>
    <text x="660" y="610" text-anchor="middle" font-size="10" fill="#ffffff">📊 성능 수집</text>
    <text x="660" y="625" text-anchor="middle" font-size="9" fill="#ffffff">응답시간, 상태</text>
    
    <!-- 대시보드 업데이트 -->
    <rect x="730" y="590" width="100" height="50" rx="4" fill="#607D8B" stroke="#455a64" stroke-width="1"/>
    <text x="780" y="610" text-anchor="middle" font-size="10" fill="#ffffff">📈 대시보드 업데이트</text>
    <text x="780" y="625" text-anchor="middle" font-size="9" fill="#ffffff">실시간 시각화</text>
    
    <!-- LangFuse 동기화 -->
    <rect x="490" y="670" width="120" height="50" rx="4" fill="#FF9800" stroke="#f57c00" stroke-width="1"/>
    <text x="550" y="690" text-anchor="middle" font-size="10" fill="#ffffff">📊 LangFuse 동기화</text>
    <text x="550" y="705" text-anchor="middle" font-size="9" fill="#ffffff">외부 모니터링</text>
  </g>
  
  <!-- 연결선들 및 화살표 -->
  <defs>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2196F3"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#FF5722"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4CAF50"/>
    </marker>
    <marker id="arrowhead-gray" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#607D8B"/>
    </marker>
  </defs>
  
  <!-- 사용자 -> 업로드 -->
  <line x1="580" y1="120" x2="130" y2="200" stroke="#2196F3" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
  
  <!-- 사용자 -> 질의 -->
  <line x1="620" y1="120" x2="730" y2="200" stroke="#2196F3" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
  
  <!-- 문서 처리 플로우 내부 연결 -->
  <line x1="190" y1="225" x2="220" y2="225" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="280" y1="250" x2="130" y2="300" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="280" y1="250" x2="230" y2="300" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="280" y1="250" x2="330" y2="300" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="280" y1="250" x2="430" y2="300" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  
  <line x1="130" y1="350" x2="130" y2="410" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="230" y1="350" x2="130" y2="410" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="330" y1="350" x2="130" y2="410" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="430" y1="350" x2="130" y2="410" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  
  <line x1="190" y1="435" x2="220" y2="435" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="340" y1="435" x2="370" y2="435" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <line x1="430" y1="460" x2="430" y2="480" stroke="#FF5722" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  
  <!-- 질의 응답 플로우 내부 연결 -->
  <line x1="790" y1="225" x2="820" y2="225" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <line x1="940" y1="225" x2="970" y2="225" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <line x1="1030" y1="250" x2="880" y2="300" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <line x1="820" y1="325" x2="790" y2="325" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <line x1="730" y1="300" x2="600" y2="140" stroke="#4CAF50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  
  <!-- 모니터링 플로우 연결 -->
  <line x1="280" y1="460" x2="420" y2="590" stroke="#607D8B" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-gray)"/>
  <line x1="470" y1="615" x2="490" y2="615" stroke="#607D8B" stroke-width="2" marker-end="url(#arrowhead-gray)"/>
  <line x1="590" y1="615" x2="610" y2="615" stroke="#607D8B" stroke-width="2" marker-end="url(#arrowhead-gray)"/>
  <line x1="710" y1="615" x2="730" y2="615" stroke="#607D8B" stroke-width="2" marker-end="url(#arrowhead-gray)"/>
  <line x1="420" y1="640" x2="550" y2="670" stroke="#607D8B" stroke-width="2" marker-end="url(#arrowhead-gray)"/>
  
  <!-- 플로우 설명 -->
  <text x="300" y="800" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#6b7280">
    📤 PDF 업로드 → 🤖 Multi-Agent 처리 → 🗂️ 벡터 저장 → ✅ 검색 준비
  </text>
  
  <text x="850" y="830" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#6b7280">
    💭 사용자 질의 → 🔍 RAG 검색 → 🤖 AI 답변 → 📝 결과 전달
  </text>
  
  <text x="600" y="860" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#6b7280">
    📊 모든 과정이 실시간으로 모니터링되고 성능이 추적됩니다
  </text>
</svg>




